
<!-- saved from url=(0233)https://alt-5a3199fc4282a.blackboard.com/bbcswebdav/pid-12912533-dt-content-rid-286418519_1/courses/33746.202235/Climate_Information_Plotting_Exp3.html?one_hash=2822EB72B46A438822E8AD3D01A1E5E9&f_hash=48E044B3295F63BDF55230D751B8B2D1 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <title>Climate Monitoring</title>
    <script type="text/javascript" src="./Climate Monitoring2_files/loader.js"></script>
  <script type="text/javascript" charset="UTF-8" src="./Climate Monitoring2_files/loader(1).js"></script><link id="load-css-0" rel="stylesheet" type="text/css" href="./Climate Monitoring2_files/tooltip.css"><link id="load-css-1" rel="stylesheet" type="text/css" href="./Climate Monitoring2_files/util.css"><script type="text/javascript" charset="UTF-8" src="./Climate Monitoring2_files/jsapi_compiled_default_module.js"></script><script type="text/javascript" charset="UTF-8" src="./Climate Monitoring2_files/jsapi_compiled_graphics_module.js"></script><script type="text/javascript" charset="UTF-8" src="./Climate Monitoring2_files/jsapi_compiled_ui_module.js"></script><script type="text/javascript" charset="UTF-8" src="./Climate Monitoring2_files/jsapi_compiled_corechart_module.js"></script><style>
/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */</style></head>

  <body>
    <h1 align="center">Climate Monitoring</h1>
    <!--Div that will hold the pie chart-->
    <div id="temp_chart_div" align="center"><div style="position: relative;"><div dir="ltr" style="position: relative; width: 800px; height: 250px;"><div style="position: absolute; left: 0px; top: 0px; width: 100%; height: 100%;" aria-label="A chart."><svg width="800" height="250" aria-label="A chart." style="overflow: hidden;"><defs id="_ABSTRACT_RENDERER_ID_0"><clippath id="_ABSTRACT_RENDERER_ID_1"><rect x="103" y="48" width="595" height="155"></rect></clippath></defs><rect x="0" y="0" width="800" height="250" stroke="none" stroke-width="0" fill="#ffffff"></rect><g><text text-anchor="start" x="103" y="28.55" font-family="Arial" font-size="13" font-weight="bold" stroke="none" stroke-width="0" fill="#000000">Temperature Profile</text><rect x="103" y="17.5" width="595" height="13" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect></g><g><rect x="103" y="48" width="595" height="155" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g clip-path="url(https://alt-5a3199fc4282a.blackboard.com/bbcswebdav/pid-12912533-dt-content-rid-286418519_1/courses/33746.202235/Climate_Information_Plotting_Exp3.html?one_hash=2822EB72B46A438822E8AD3D01A1E5E9&amp;f_hash=48E044B3295F63BDF55230D751B8B2D1#_ABSTRACT_RENDERER_ID_1)"><g><rect x="103" y="48" width="1" height="155" stroke="none" stroke-width="0" fill="#cccccc"></rect><rect x="697" y="48" width="1" height="155" stroke="none" stroke-width="0" fill="#cccccc"></rect><rect x="103" y="202" width="595" height="1" stroke="none" stroke-width="0" fill="#cccccc"></rect><rect x="103" y="125" width="595" height="1" stroke="none" stroke-width="0" fill="#cccccc"></rect><rect x="103" y="48" width="595" height="1" stroke="none" stroke-width="0" fill="#cccccc"></rect><rect x="103" y="164" width="595" height="1" stroke="none" stroke-width="0" fill="#ebebeb"></rect><rect x="103" y="87" width="595" height="1" stroke="none" stroke-width="0" fill="#ebebeb"></rect></g><g><rect x="103" y="202" width="595" height="1" stroke="none" stroke-width="0" fill="#333333"></rect></g></g><g></g><g><g><text text-anchor="middle" x="103.5" y="221.05" font-family="Arial" font-size="13" stroke="none" stroke-width="0" fill="#444444">19:00:00.000</text></g><g><text text-anchor="middle" x="697.5" y="221.05" font-family="Arial" font-size="13" stroke="none" stroke-width="0" fill="#444444">19:00:00.001</text></g><g><text text-anchor="end" x="90" y="207.05" font-family="Arial" font-size="13" stroke="none" stroke-width="0" fill="#444444">0</text></g><g><text text-anchor="end" x="90" y="130.05" font-family="Arial" font-size="13" stroke="none" stroke-width="0" fill="#444444">20</text></g><g><text text-anchor="end" x="90" y="53.05" font-family="Arial" font-size="13" stroke="none" stroke-width="0" fill="#444444">40</text></g></g></g><g><g><text text-anchor="middle" x="400.5" y="241.05" font-family="Arial" font-size="13" font-style="italic" stroke="none" stroke-width="0" fill="#222222">Time</text><rect x="103" y="230" width="595" height="13" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect></g><g><text text-anchor="middle" x="42.55" y="125.5" font-family="Arial" font-size="13" font-style="italic" transform="rotate(-90 42.55 125.5)" stroke="none" stroke-width="0" fill="#222222">Temperature (C)</text><path d="M31.499999999999996,203L31.500000000000004,48L44.50000000000001,48L44.49999999999999,203Z" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></path></g></g><g></g></svg><div aria-label="A tabular representation of the data in the chart." style="position: absolute; left: -10000px; top: auto; width: 1px; height: 1px; overflow: hidden;"><table><thead><tr><th>Time</th><th>Temperature (C)</th></tr></thead><tbody></tbody></table></div></div></div><div aria-hidden="true" style="display: none; position: absolute; top: 260px; left: 810px; white-space: nowrap; font-family: Arial; font-size: 13px; font-weight: bold;">Temperature Profile</div><div></div></div></div>
    <div id="humid_chart_div" align="center"><div style="position: relative;"><div dir="ltr" style="position: relative; width: 800px; height: 250px;"><div style="position: absolute; left: 0px; top: 0px; width: 100%; height: 100%;" aria-label="A chart."><svg width="800" height="250" aria-label="A chart." style="overflow: hidden;"><defs id="_ABSTRACT_RENDERER_ID_2"><clippath id="_ABSTRACT_RENDERER_ID_3"><rect x="103" y="48" width="595" height="155"></rect></clippath></defs><rect x="0" y="0" width="800" height="250" stroke="none" stroke-width="0" fill="#ffffff"></rect><g><text text-anchor="start" x="103" y="28.55" font-family="Arial" font-size="13" font-weight="bold" stroke="none" stroke-width="0" fill="#000000">Humidity Profile</text><rect x="103" y="17.5" width="595" height="13" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect></g><g><rect x="103" y="48" width="595" height="155" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g clip-path="url(https://alt-5a3199fc4282a.blackboard.com/bbcswebdav/pid-12912533-dt-content-rid-286418519_1/courses/33746.202235/Climate_Information_Plotting_Exp3.html?one_hash=2822EB72B46A438822E8AD3D01A1E5E9&amp;f_hash=48E044B3295F63BDF55230D751B8B2D1#_ABSTRACT_RENDERER_ID_3)"><g><rect x="103" y="48" width="1" height="155" stroke="none" stroke-width="0" fill="#cccccc"></rect><rect x="697" y="48" width="1" height="155" stroke="none" stroke-width="0" fill="#cccccc"></rect><rect x="103" y="202" width="595" height="1" stroke="none" stroke-width="0" fill="#cccccc"></rect><rect x="103" y="125" width="595" height="1" stroke="none" stroke-width="0" fill="#cccccc"></rect><rect x="103" y="48" width="595" height="1" stroke="none" stroke-width="0" fill="#cccccc"></rect><rect x="103" y="164" width="595" height="1" stroke="none" stroke-width="0" fill="#ebebeb"></rect><rect x="103" y="87" width="595" height="1" stroke="none" stroke-width="0" fill="#ebebeb"></rect></g><g><rect x="103" y="202" width="595" height="1" stroke="none" stroke-width="0" fill="#333333"></rect></g></g><g></g><g><g><text text-anchor="middle" x="103.5" y="221.05" font-family="Arial" font-size="13" stroke="none" stroke-width="0" fill="#444444">19:00:00.000</text></g><g><text text-anchor="middle" x="697.5" y="221.05" font-family="Arial" font-size="13" stroke="none" stroke-width="0" fill="#444444">19:00:00.001</text></g><g><text text-anchor="end" x="90" y="207.05" font-family="Arial" font-size="13" stroke="none" stroke-width="0" fill="#444444">0</text></g><g><text text-anchor="end" x="90" y="130.05" font-family="Arial" font-size="13" stroke="none" stroke-width="0" fill="#444444">50</text></g><g><text text-anchor="end" x="90" y="53.05" font-family="Arial" font-size="13" stroke="none" stroke-width="0" fill="#444444">100</text></g></g></g><g><g><text text-anchor="middle" x="400.5" y="241.05" font-family="Arial" font-size="13" font-style="italic" stroke="none" stroke-width="0" fill="#222222">Time</text><rect x="103" y="230" width="595" height="13" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect></g><g><text text-anchor="middle" x="38.55" y="125.5" font-family="Arial" font-size="13" font-style="italic" transform="rotate(-90 38.55 125.5)" stroke="none" stroke-width="0" fill="#222222">Humidity (%)</text><path d="M27.499999999999996,203L27.500000000000004,48L40.50000000000001,48L40.49999999999999,203Z" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></path></g></g><g></g></svg><div aria-label="A tabular representation of the data in the chart." style="position: absolute; left: -10000px; top: auto; width: 1px; height: 1px; overflow: hidden;"><table><thead><tr><th>Time</th><th>Humidity (%)</th></tr></thead><tbody></tbody></table></div></div></div><div aria-hidden="true" style="display: none; position: absolute; top: 260px; left: 810px; white-space: nowrap; font-family: Arial; font-size: 13px; font-weight: bold;">Humidity Profile</div><div></div></div></div>
    <script type="text/javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawChart);

      // constrain max points to display
      const max_points = 20;

      // Set chart options
      const tempChartOptions = {
        title: 'Temperature Profile',
        width: 800, 
        height: 250,
        legend: 'none',
        vAxis: { title: 'Temperature (C)', viewWindowMode: "pretty" , minValue: 0, maxValue: 40},
        hAxis: { title: 'Time' }
      };

      const humidChartOptions = {
        title: 'Humidity Profile',
        width: 800, 
        height: 250,
        legend: 'none',
        vAxis: { title: 'Humidity (%)', viewWindowMode: "pretty" , minValue: 0, maxValue: 100},
        hAxis: { title: 'Time' }
      };


      // Modified websocket code to update Google Chart on each message from ESP
      // This code will run at the end of the drawChart() callback
      function initWebsocket(tempChart, tempDataTable, humidChart, humidDataTable) {
        const ws = new WebSocket("ws://ENTER ESP32 IP ADDRESS:80");
        ws.onmessage = (evt) => {
          const data = JSON.parse(evt.data);
          const temp = data['Temperature'];
          const humid = data['Humidity'];

          const now = new Date();
          tempDataTable.addRow([now, temp]);
          humidDataTable.addRow([now, humid]);

          if (tempDataTable.getNumberOfRows() > max_points) {
            tempDataTable.removeRow(0);
            humidDataTable.removeRow(0);
          }

          tempChart.draw(tempDataTable, tempChartOptions);
          humidChart.draw(humidDataTable, humidChartOptions);
        }
        // close websocket when leaving the page
        window.onbeforeunload = () => {
          ws.close();
        };
      }

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {

        // Create the data tables
        const tempDataTable = new google.visualization.DataTable();
        tempDataTable.addColumn('date', 'Time');
        tempDataTable.addColumn('number', 'Temperature (C)');

        const humidDataTable = new google.visualization.DataTable();
        humidDataTable.addColumn('date', 'Time');
        humidDataTable.addColumn('number', 'Humidity (%)');

        // Instantiate and draw our chart, passing in some options.
        const tempChart = new google.visualization.ScatterChart(document.getElementById('temp_chart_div'));
        tempChart.draw(tempDataTable, tempChartOptions);

        const humidChart = new google.visualization.ScatterChart(document.getElementById('humid_chart_div'));
        humidChart.draw(humidDataTable, humidChartOptions);

        initWebsocket(tempChart, tempDataTable, humidChart, humidDataTable);
      }
    </script>
  
<div id="veed-recorder-root"><template shadowrootmode="open"><section><div><div class="App" style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;"><iframe title="veed-extension-permissions" allow="camera *; microphone *;" src="chrome-extension://mgipbckfkdcalgbcjmkogjijddnkbecc/iframe.html" style="display: none;"></iframe></div></div></section><link rel="stylesheet" href="chrome-extension://mgipbckfkdcalgbcjmkogjijddnkbecc/content-root.css"></template></div><div id="hl-aria-live-message-container" aria-live="polite" class="visually-hidden"></div><div id="hl-aria-live-alert-container" role="alert" aria-live="assertive" class="visually-hidden"></div></body></html>